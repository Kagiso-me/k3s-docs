# ==========================
# kube-prometheus-stack values (k3s + pinned images)
# ==========================

# --------------------------
# Grafana configuration
# --------------------------
grafana:
  enabled: true
  adminUser: admin
  adminPassword: admin        # CHANGE after first login
  ingress:
    enabled: false           # disable all ingress/TLS
  persistence:
    enabled: true
    storageClassName: nfs-core-appdata
    accessModes:
      - ReadWriteMany
    size: 5Gi
  sidecar:
    dashboards:
      enabled: false         # disable dashboards sidecar since no custom dashboards yet
      image:
        repository: quay.io/kiwigrid/k8s-sidecar
        tag: 2.1.1          # pinned stable version

# --------------------------
# Prometheus configuration
# --------------------------
prometheus:
  enabled: true
  prometheusSpec:
    retention: 15d
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: nfs-core-appdata
          accessModes:
            - ReadWriteMany
          resources:
            requests:
              storage: 20Gi
  # Pin Prometheus image
  prometheusSpec:
    image:
      repository: quay.io/prometheus/prometheus
      tag: v2.48.0              # stable Prometheus version

# --------------------------
# Alertmanager configuration
# --------------------------
alertmanager:
  enabled: true
  alertmanagerSpec:
    storage:
      volumeClaimTemplate:
        spec:
          storageClassName: nfs-core-appdata
          accessModes:
            - ReadWriteMany
          resources:
            requests:
              storage: 5Gi

# --------------------------
# Prometheus Operator
# --------------------------
prometheusOperator:
  image:
    repository: quay.io/prometheus-operator/prometheus-operator
    tag: v0.87.1               # pinned stable version

# --------------------------
# Node Exporter
# --------------------------
nodeExporter:
  image:
    repository: quay.io/prometheus/node-exporter
    tag: v1.10.1               # pinned stable version

# --------------------------
# k3s control-plane optimizations
# --------------------------
kubeControllerManager:
  enabled: false

kubeScheduler:
  enabled: false

kubeEtcd:
  enabled: false
